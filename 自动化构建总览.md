# 自动化构建APK - 完整指南

## 🎯 3种自动化构建方法对比

| 方法 | 难度 | 时间 | 优势 | 劣势 |
|------|------|------|------|------|
| **GitHub Actions** ⭐推荐 | ⭐ 简单 | 首次15-25分钟 | 完全自动化、免费、无需本地环境 | 需要GitHub账号 |
| **本地WSL构建** | ⭐⭐ 中等 | 首次20-40分钟 | 完全控制、离线可用 | 需要WSL、首次配置复杂 |
| **Docker构建** | ⭐⭐⭐ 困难 | 首次30-60分钟 | 环境隔离、可重复 | 需要Docker、占用空间大 |

---

## 方法1: GitHub Actions 自动构建 ⭐推荐

**最简单、最自动化的方式！**

### 优势
- ✅ 零本地配置 - 不需要安装任何工具
- ✅ 完全自动 - 推送代码即自动构建
- ✅ 免费使用 - 公开仓库无限制
- ✅ 云端构建 - 不占用本地资源

### 快速开始

#### 步骤1: 安装Git（如果没有）

下载：https://git-scm.com/download/win

#### 步骤2: 双击运行

```
📁 一键推送到GitHub.bat
```

按照提示输入：
- GitHub用户名
- 确认推送

#### 步骤3: 等待自动构建

1. 访问你的GitHub仓库
2. 点击 "Actions" 标签
3. 查看构建进度（15-25分钟）
4. 构建完成后下载APK

### 详细教程

查看：`GitHub自动构建教程.md`

---

## 方法2: 本地WSL构建

**适合想要完全控制构建过程的用户**

### 优势
- ✅ 离线可用
- ✅ 构建速度快（后续构建）
- ✅ 完全控制

### 快速开始

#### 步骤1: 安装WSL

PowerShell（管理员）运行：
```powershell
wsl --install
```
重启电脑。

#### 步骤2: 在WSL中安装依赖

打开"Ubuntu"终端：
```bash
sudo apt-get update
sudo apt-get install -y python3-pip git openjdk-11-jdk
pip3 install buildozer cython
```

#### 步骤3: 构建APK

```bash
# 复制项目
cp -r /mnt/c/Users/Administrator/Desktop/shuchu/android_app ~/
cd ~/android_app

# 构建
buildozer android debug

# 复制APK到Windows桌面
cp bin/*.apk /mnt/c/Users/Administrator/Desktop/
```

### 详细教程

查看：`Windows构建说明.md`

---

## 方法3: Docker构建

**适合熟悉Docker的用户**

### 优势
- ✅ 环境隔离
- ✅ 可重复构建
- ✅ 跨平台

### 快速开始

#### 步骤1: 安装Docker Desktop

下载：https://www.docker.com/products/docker-desktop/

#### 步骤2: 构建APK

PowerShell中运行：
```powershell
cd C:\Users\Administrator\Desktop\shuchu\android_app
docker run --rm -v ${PWD}:/app kivy/buildozer android debug
```

APK会生成在 `bin/` 目录。

---

## 🚀 推荐方案选择

### 如果你是新手
→ 使用 **GitHub Actions**（方法1）
- 最简单
- 双击运行批处理文件即可
- 完全自动化

### 如果你想快速构建多次
→ 使用 **WSL**（方法2）
- 首次配置后构建很快
- 离线可用
- 完全控制

### 如果你熟悉容器技术
→ 使用 **Docker**（方法3）
- 环境一致性好
- 适合CI/CD集成

---

## 📊 构建时间对比

| 方法 | 首次构建 | 后续构建 | 下载速度 |
|------|---------|---------|---------|
| GitHub Actions | 15-25分钟 | 10-15分钟 | 取决于网络 |
| WSL | 20-40分钟 | 5-10分钟 | 本地访问 |
| Docker | 30-60分钟 | 15-20分钟 | 本地访问 |

---

## 🎬 开始使用

### 最快速的方法（GitHub Actions）：

1. **双击运行**: `一键推送到GitHub.bat`
2. **输入用户名**: 你的GitHub用户名
3. **等待推送**: 自动推送代码到GitHub
4. **查看Actions**: 访问你的仓库 → Actions标签
5. **下载APK**: 构建完成后从Artifacts下载

**就这么简单！**

---

## ❓ 常见问题

### Q: 我应该选择哪种方法？

**A**: 
- 新手 → GitHub Actions
- 频繁构建 → WSL
- 团队协作 → GitHub Actions
- 追求速度 → WSL（首次配置后）

### Q: GitHub Actions免费吗？

**A**: 
- 公开仓库：完全免费，无限制
- 私有仓库：每月2000分钟免费

### Q: 构建失败怎么办？

**A**: 查看对应方法的详细教程：
- GitHub Actions → `GitHub自动构建教程.md`
- WSL → `Windows构建说明.md`
- Docker → `README.md`

### Q: 能同时使用多种方法吗？

**A**: 可以！它们互不冲突：
- 用GitHub Actions自动构建发布版
- 用WSL快速测试本地修改

---

## 📁 相关文档

- `GitHub自动构建教程.md` - GitHub Actions详细教程
- `Windows构建说明.md` - WSL构建详细教程  
- `README.md` - 项目完整说明
- `快速开始.txt` - 最简单的入门指南

---

## 🎉 推荐路线

**第一次构建**：
1. 使用 GitHub Actions（双击运行批处理）
2. 下载APK并测试

**如果需要频繁修改**：
1. 设置WSL环境
2. 本地快速构建测试
3. 最终版本推送到GitHub自动发布

**最佳实践**：
- 日常开发：本地WSL构建
- 版本发布：GitHub Actions自动发布
- 团队协作：统一使用GitHub Actions

---

## 💡 小技巧

### 加速GitHub Actions构建

在 `.github/workflows/build-apk.yml` 添加缓存：

```yaml
- name: 缓存Buildozer
  uses: actions/cache@v3
  with:
    path: ~/.buildozer
    key: buildozer-${{ hashFiles('buildozer.spec') }}
```

### 加速WSL构建

保留构建缓存：
```bash
# 不要删除 .buildozer 目录
# 后续构建会使用缓存，快很多
```

### 自动发布到Release

创建Git标签：
```bash
git tag v1.0.0
git push origin v1.0.0
```

GitHub Actions会自动创建Release并附上APK。

---

## 📞 获取帮助

遇到问题？按优先级查看：

1. **快速开始.txt** - 最简单的指南
2. **GitHub自动构建教程.md** - GitHub Actions详细说明
3. **Windows构建说明.md** - WSL详细说明
4. **README.md** - 完整项目文档

---

## ✅ 检查清单

构建前确认：

- [ ] 已安装Git（如果用GitHub Actions）
- [ ] 已创建GitHub账号（如果用GitHub Actions）
- [ ] 项目文件完整（main.py, buildozer.spec等）
- [ ] 网络连接正常

构建后确认：

- [ ] APK文件已生成
- [ ] APK大小正常（20-30MB）
- [ ] 可以正常安装到手机

---

**开始你的第一次自动化构建吧！** 🚀
